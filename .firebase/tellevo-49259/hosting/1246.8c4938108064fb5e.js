"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[1246],{1246:(E,g,a)=>{a.r(g),a.d(g,{ProfilePageModule:()=>T});var f=a(177),v=a(4341),s=a(4742),h=a(9384),m=a(467),e=a(4438),P=a(385),y=a(5265),_=a(6643),S=a(9381);function b(n,r){if(1&n&&e.nrm(0,"img",10),2&n){let o;const t=e.XpG();e.Y8G("src",null==(o=t.user())?null:o.image,e.B4B)}}function $(n,r){1&n&&e.nrm(0,"ion-icon",11)}function F(n,r){if(1&n){const o=e.RV6();e.j41(0,"ion-item",12),e.bIt("click",function(){const i=e.eBV(o).$implicit,l=e.XpG();return e.Njj(l.addUpdateVehicle(i))}),e.nrm(1,"ion-icon",13),e.j41(2,"ion-label"),e.EFF(3),e.k0s()()}if(2&n){const o=r.$implicit;e.R7$(3),e.Lme("Editar veh\xedculo ",o.marca," ",o.modelo,"")}}function j(n,r){if(1&n){const o=e.RV6();e.j41(0,"ion-item",12),e.bIt("click",function(){const i=e.eBV(o).$implicit,l=e.XpG();return e.Njj(l.presentAlertConfirm(i))}),e.nrm(1,"ion-icon",13),e.j41(2,"ion-label"),e.EFF(3),e.k0s()()}if(2&n){const o=r.$implicit;e.R7$(3),e.Lme("Eliminar veh\xedculo ",o.marca," ",o.modelo,"")}}const I=[{path:"",component:(()=>{var n;class r{constructor(){this.firebaseSvc=(0,e.WQX)(P.f),this.utilSvc=(0,e.WQX)(y.T),this.vehicles=[],this.loading=!1}ngOnInit(){}user(){return this.utilSvc.getFromLocalStorage("user")}ionViewWillEnter(){this.getVehicle()}takeImage(){var t=this;return(0,m.A)(function*(){let i=t.user(),l=`users/${i.uid}`;const c=(yield t.utilSvc.takePicture("Imagen de perfil")).dataUrl,u=yield t.utilSvc.loading();yield u.present();let p=`${i.uid}/profile`;i.image=yield t.firebaseSvc.uploadImage(p,c),t.firebaseSvc.updateDocument(l,{image:i.image}).then(function(){var d=(0,m.A)(function*(k){t.utilSvc.saveInLocalStorage("user",i),t.utilSvc.presentToast({message:"Imagen actualizada correctamente",duration:1500,color:"success",position:"middle",icon:"checkmark-circle-outline"})});return function(k){return d.apply(this,arguments)}}()).catch(d=>{console.log(d),t.utilSvc.presentToast({message:d.message,duration:2500,color:"primary",position:"middle",icon:"alert-circle-outline"})}).finally(()=>{u.dismiss()})})()}getVehicle(){let t=`users/${this.user().uid}/vehicles`;this.loading=!0;let i=this.firebaseSvc.getCollectionData(t).subscribe({next:l=>{console.log(l),this.vehicles=l,this.loading=!1,i.unsubscribe()}})}addUpdateVehicle(t){var i=this;return(0,m.A)(function*(){(yield i.utilSvc.presentModal({component:_.I,cssClass:"add-update-modal",componentProps:{vehiculo:t}}))&&i.getVehicle()})()}presentAlertConfirm(t){var i=this;return(0,m.A)(function*(){i.utilSvc.presentAlert({header:"Confirmar eliminaci\xf3n",message:`\xbfEst\xe1s seguro de que deseas eliminar el veh\xedculo ${t.marca}?`,buttons:[{text:"Cancelar"},{text:"Eliminar",handler:()=>{i.deleteVehicle(t)}}]})})()}deleteVehicle(t){var i=this;return(0,m.A)(function*(){let l=`users/${i.user().uid}/vehicles/${t.id}`;const c=yield i.utilSvc.loading();yield c.present(),i.firebaseSvc.deleteDocument(l).then(function(){var u=(0,m.A)(function*(p){i.vehicles=i.vehicles.filter(d=>d.id!==t.id),i.utilSvc.presentToast({message:"Veh\xedculo eliminado correctamente",duration:1500,color:"success",position:"middle",icon:"checkmark-circle-outline"})});return function(p){return u.apply(this,arguments)}}()).catch(u=>{console.log(u),i.utilSvc.presentToast({message:u.message,duration:2500,color:"primary",position:"middle",icon:"alert-circle-outline"})}).finally(()=>{c.dismiss()})})()}}return(n=r).\u0275fac=function(t){return new(t||n)},n.\u0275cmp=e.VBU({type:n,selectors:[["app-profile"]],decls:19,vars:6,consts:[["title","Perfil",3,"showMenu"],[1,"ion-padding-top","ion-text-center"],[3,"src",4,"ngIf"],["class","empty-icon","name","person-circle-outline",4,"ngIf"],["mode","ios","size","small","shape","round",1,"photo-btn",3,"click"],["name","camera-outline"],["button","","detail",""],["color","primary","slot","start","name","person-outline"],["button","","detail","",3,"click",4,"ngFor","ngForOf"],["color","primary","slot","start","name","document-outline"],[3,"src"],["name","person-circle-outline",1,"empty-icon"],["button","","detail","",3,"click"],["color","primary","slot","start","name","car-outline"]],template:function(t,i){if(1&t&&(e.nrm(0,"app-header",0),e.j41(1,"ion-content",1)(2,"ion-avatar"),e.DNE(3,b,1,1,"img",2)(4,$,1,0,"ion-icon",3),e.k0s(),e.j41(5,"ion-button",4),e.bIt("click",function(){return i.takeImage()}),e.nrm(6,"ion-icon",5),e.k0s(),e.j41(7,"h2"),e.EFF(8),e.k0s(),e.j41(9,"ion-item",6),e.nrm(10,"ion-icon",7),e.j41(11,"ion-label"),e.EFF(12,"Editar perfil"),e.k0s()(),e.DNE(13,F,4,2,"ion-item",8)(14,j,4,2,"ion-item",8),e.j41(15,"ion-item",6),e.nrm(16,"ion-icon",9),e.j41(17,"ion-label"),e.EFF(18,"Terminos y condiciones"),e.k0s()()()),2&t){let l,c;e.Y8G("showMenu",!0),e.R7$(3),e.Y8G("ngIf",null==(l=i.user())?null:l.image),e.R7$(),e.Y8G("ngIf",!(null!=(c=i.user())&&c.image)),e.R7$(4),e.JRh(i.user().name),e.R7$(5),e.Y8G("ngForOf",i.vehicles),e.R7$(),e.Y8G("ngForOf",i.vehicles)}},dependencies:[f.Sq,f.bT,s.mC,s.Jm,s.W9,s.iq,s.uz,s.he,S.l],styles:["ion-avatar[_ngcontent-%COMP%]{width:140px;height:140px;margin:0 auto}.photo-btn[_ngcontent-%COMP%]{position:relative;bottom:25px}ion-item[_ngcontent-%COMP%]{padding-top:15px}.empty-icon[_ngcontent-%COMP%]{font-size:140px;opacity:30%}"]}),r})()}];let M=(()=>{var n;class r{}return(n=r).\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.$C({type:n}),n.\u0275inj=e.G2t({imports:[h.iI.forChild(I),h.iI]}),r})();var C=a(3887);let T=(()=>{var n;class r{}return(n=r).\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.$C({type:n}),n.\u0275inj=e.G2t({imports:[f.MD,v.YN,s.bv,M,C.G]}),r})()}}]);